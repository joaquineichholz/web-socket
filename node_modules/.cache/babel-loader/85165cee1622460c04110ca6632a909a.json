{"ast":null,"code":"var _jsxFileName = \"/home/joaquin/Escritorio/t03-taller_integracion/src/App.js\";\nimport React, { Component } from 'react';\nimport './App.css'; //import Graph from './components/graph';\n\nimport io from 'socket.io-client';\nimport './css/navbar.css';\nimport Disconnect from './components/disconnect';\nimport Connect from './components/connect';\nimport Stock from './components/stock'; //import Price from './components/prices';\n\nconst protocolo = \"wss://\";\nconst servidor = \"le-18262636.bitzonte.com\";\nconst ruta = \"/stocks\";\nconst socket = io(protocolo + servidor, {\n  path: ruta\n});\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      stock: [],\n      prices: []\n    };\n\n    this.update = current => {\n      console.log('1.- prices:', this.state.prices);\n      var new_ticker = true;\n      this.state.prices.map(data => {\n        if (data.ticker === current.ticker) {\n          new_ticker = false;\n        }\n      });\n\n      if (!new_ticker) {\n        this.setState({\n          prices: this.state.prices.map(data => {\n            console.log('if 1.- prices:', this.state.prices);\n\n            if (data.ticker === current.ticker) {\n              data.value.push(current.value);\n              data.time.push(current.time);\n              new_ticker = false;\n            }\n\n            console.log('if 2.- prices:', this.state.prices);\n          })\n        });\n      }\n\n      console.log('2.- prices:', this.state.prices);\n\n      if (new_ticker) {\n        var new_price = this.state.prices;\n        var list_price = [current.value];\n        var list_time = [current.time];\n        console.log(' ');\n        console.log('3.- prices:', this.state.prices);\n        console.log('--- crear --');\n        new_price.push({\n          ticker: current.ticker,\n          value: list_price,\n          time: list_time\n        });\n        console.log('5.- prices:', this.state.prices);\n        this.setState({\n          prices: new_price\n        });\n        console.log('6.- prices:', this.state.prices);\n        console.log('new_price:', new_price);\n        console.log(' ');\n      }\n    };\n\n    this.add_sell = current => {\n      var new_sell = true;\n      this.setState({\n        stocks: this.state.stock.map(data => {\n          console.log(data.ticker, '==', current.ticker);\n\n          if (data.ticker === current.ticker) {\n            data.volume += current.volume;\n            new_sell = false;\n          }\n        })\n      });\n\n      if (new_sell) {\n        var new_stock = this.state.stock;\n        new_stock.push({\n          ticker: current.ticker,\n          volume: current.volume,\n          time: current.time\n        });\n        this.setState({\n          stocks: new_stock\n        });\n      }\n    };\n\n    this.disconnect = e => {\n      socket.disconnect();\n      console.log('###############################################');\n      console.log('################## DISCONNECT #################');\n      console.log('###############################################');\n    };\n\n    this.connect = e => {\n      socket.connect();\n      console.log('###############################################');\n      console.log('##################  CONNECT   #################');\n      console.log('###############################################');\n    };\n  }\n\n  componentDidMount() {\n    console.log('PÃ¡gina montada');\n    console.log('Encendiendo socket');\n    socket.on(\"UPDATE\", data => {\n      console.log('data socket update:', data);\n      this.update(data);\n    });\n    socket.on(\"BUY\", data => {//console.log(data);\n      //console.log('\\n+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +  ');\n    });\n    socket.on(\"SELL\", data => {//this.add_sell(data)\n    }); //data.map((data) => (\n    //\n    //));\n  }\n\n  render() {\n    //console.log(this.state.data)\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      className: \"nav-ul\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      className: \"nav-li\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 11\n      }\n    }, \" \", /*#__PURE__*/React.createElement(Disconnect, {\n      disconnect: this.disconnect,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 35\n      }\n    }), \"  \"), /*#__PURE__*/React.createElement(\"li\", {\n      className: \"nav-li\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Connect, {\n      connect: this.connect,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 34\n      }\n    }))), /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 10\n      }\n    }, \" Mercado de acciones  \"), /*#__PURE__*/React.createElement(Stock, {\n      stock: this.state.stock,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/joaquin/Escritorio/t03-taller_integracion/src/App.js"],"names":["React","Component","io","Disconnect","Connect","Stock","protocolo","servidor","ruta","socket","path","App","state","stock","prices","update","current","console","log","new_ticker","map","data","ticker","setState","value","push","time","new_price","list_price","list_time","add_sell","new_sell","stocks","volume","new_stock","disconnect","e","connect","componentDidMount","on","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\n//import Graph from './components/graph';\nimport io from 'socket.io-client';\nimport './css/navbar.css'\n\nimport Disconnect from './components/disconnect';\nimport Connect from './components/connect';\nimport Stock from './components/stock';\n//import Price from './components/prices';\n\n\nconst protocolo = \"wss://\";\nconst servidor = \"le-18262636.bitzonte.com\";\nconst ruta = \"/stocks\";\n\nconst socket = io(protocolo + servidor , {\n  path: ruta\n  });\n\nclass App extends Component {\n\n  state = {\n      stock: [\n      ],\n\n      prices: [\n\n      ]\n  }\n  update = (current) => {\n  console.log('1.- prices:', this.state.prices)\n    \n    var new_ticker = true;\n\n    this.state.prices.map( data => { \n      if (data.ticker === current.ticker) {\n        new_ticker = false;\n              }\n    })\n    if (!new_ticker) {\n      this.setState({prices: this.state.prices.map( data => {\n        console.log('if 1.- prices:', this.state.prices)\n  \n        if (data.ticker === current.ticker) {\n          data.value.push(current.value)\n          data.time.push(current.time)\n          new_ticker = false\n        }\n    console.log('if 2.- prices:', this.state.prices)\n  \n      })\n    })\n\n    }\n  \n  console.log('2.- prices:', this.state.prices)\n\n\n  if (new_ticker) {\n\n    var new_price = this.state.prices\n    var list_price = [current.value]\n    var list_time = [current.time]\n\n    console.log(' ')\n    console.log('3.- prices:', this.state.prices)\n    console.log('--- crear --')\n\n    new_price.push({\n      ticker: current.ticker,\n      value: list_price,\n      time: list_time\n     })\n\n    console.log('5.- prices:', this.state.prices)\n    this.setState({prices: new_price})\n\n    console.log('6.- prices:', this.state.prices)\n    console.log('new_price:', new_price)\n    console.log(' ')\n    }\n\n  }\n\n\n  add_sell = (current) => {\n    var new_sell = true;\n    \n    this.setState({stocks: this.state.stock.map( data => {\n      console.log(data.ticker, '==', current.ticker)\n      if (data.ticker === current.ticker) {\n        data.volume += current.volume\n        new_sell = false\n      }\n    })\n  \n  })\n\n  if (new_sell) {\n\n    var new_stock = this.state.stock\n     new_stock.push({\n      ticker: current.ticker,\n      volume: current.volume,\n      time: current.time\n     })\n\n    this.setState({stocks: new_stock})\n    }\n  }\n\n  disconnect = (e) => {\n    socket.disconnect();\n        console.log('###############################################');\n        console.log('################## DISCONNECT #################');\n        console.log('###############################################');\n  }\n\n  connect = (e) => {\n    socket.connect();\n    console.log('###############################################');\n    console.log('##################  CONNECT   #################');\n    console.log('###############################################');\n  }\n\n\n\n  componentDidMount() {\n    console.log('PÃ¡gina montada')\n    console.log('Encendiendo socket')\n\n    socket.on(\"UPDATE\", (data) => {\n      console.log('data socket update:', data)\n      this.update(data)\n    });\n       \n    socket.on(\"BUY\", (data) => {\n\n      //console.log(data);\n    //console.log('\\n+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +  ');\n    });\n\n    socket.on(\"SELL\", (data) => {\n      //this.add_sell(data)\n    });\n\n      //data.map((data) => (\n          //\n        //));\n\n\n  }\n\n    \n\n  render() {\n\n    //console.log(this.state.data)\n    return (\n      <div className=\"App\">\n\n        <ul className=\"nav-ul\">\n          <li className=\"nav-li\"> <Disconnect disconnect={this.disconnect} />  </li>\n          <li className=\"nav-li\"><Connect connect={this.connect} /></li>\n        </ul>\n         <h1> Mercado de acciones  </h1>\n\n        <Stock stock={this.state.stock}/>\n        \n      </div>\n      );\n    }\n}\n\n\n\n\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}